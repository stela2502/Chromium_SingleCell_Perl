#! /usr/bin/perl
use strict;
use warnings;
use stefans_libs::root;
use Test::More tests => 6;
use stefans_libs::flexible_data_structures::data_table;

use stefans_libs::database::Chromium_SingleCell::datavalues;

use FindBin;
my $plugin_path = "$FindBin::Bin";

my ( $value, @values, $exp, $gtf_file, $infile, $outfile, @options, );

my $exec = $plugin_path . "/../bin/QuantifyBamFile.pl";
ok( -f $exec, 'the script has been found' );
my $outpath =
  "$plugin_path/data/output/QuantifyBamFile_chr11_87760834_87856494";
if ( -d $outpath ) {
	system("rm -Rf $outpath");
}

$gtf_file = "$plugin_path/data/mm10.Mpo_large.gtf";

#$gtf_file = "/home/stefanl/lunarc/genomes/mouse/mm10/gencode.vM14.chr_patch_hapl_scaff.annotation.gtf";

ok( -f $gtf_file, 'test gtf file exists' );

$infile =
  "$plugin_path/data/mm10.singleCells.merged.chr11_87760834_87856494.bam";
ok( -f $infile, 'test infile exists' );

$outfile = "$outpath/singleCells.merged.chr11_87760834_87856494_quantifed";

#improvement by using UMIs to merge samples:
#no usage: 61773 samples and 4 genes
#with umi: 25261 and 4 genes
#with umi and sample merge: 16224 samples and 4 genes detected

# with only 4 geens we are down to only half the samples.

@options = (
	'min_UMIs', 1
	, 'quantify_on', 'transcript'
);

my $cmd =
    "perl "
  . "-I $plugin_path/../lib "
  . "-I $plugin_path/../../stefans_libs-BAMfile/lib/ "
  . "-I ../../Stefans_Libs_Essentials/Stefans_Libs_Essentials/lib "
  . "-I ../../SLURM_bioinformatics_scripts/lib/ "
  . "-I ../../SLURM_bioinformatics_scripts/lib/ "
  . "-I ../../stefans_libs-GenomeDB/lib "
  . "$exec "
  . " -gtf_file "
  . $gtf_file
  . " -infile "
  . $infile
  . " -outfile "
  . $outfile
  . " -options "
  . join( ' ', @options )

  #  . " -debug"
  ;

my $start = time;
system($cmd );
my $duration = time - $start;
print "Execution time: $duration s\n";

#Finished with mapping: 25261 samples and 4 gene_id's detected
#Execution time: 18 s

## when dropping samples with no hit to the transcriptome
#Finished with mapping: 9000 samples and 4 gene_id's detected
#Execution time: 19 s

## when dropping samples with less than 100 hits to the transcriptome
#Finished with mapping: 15 samples and 4 gene_id's detected
#Done
#Execution time: 25 s

## After using PDL for the computational stuff and min_umi 100
##Finished with mapping: 161 samples and 4 gene_id's detected
##Done
##Execution time: 17 s

## After using PDL for the computational stuff and min_umi 10
##Finished with mapping: 646 samples and 4 gene_id's detected
##Done
##Execution time: 19 s

@values = undef;

my $db = stefans_libs::database::Chromium_SingleCell::datavalues->new(
	{
		'file' =>
"$outpath/singleCells.merged.chr11_87760834_87856494_quantifed.original_merged.db",
		'data_storage_spliced' => 1
	}
);

$value = $db->get_data_table_4_search(
	{
		'search_columns' => [ 'sname', 'gname', 'value' ],
		'where'          => [],
	}
);

ok( $value->Rows() == 386, "386 samples(" . $value->Rows() . ")" );

print "\$exp = "
  . root->print_perl_var_def( [ sort keys %{ $value->createIndex('gname') } ] )
  . ";\n";

$exp = [
	'1',                     'ENSMUSG00000009350.13',
	'ENSMUSG00000009356.12', 'ENSMUSG00000034121.12',
	'ENSMUSG00000034156.16'
];

is_deeply( [ sort keys %{ $value->createIndex('gname') } ],
	$exp, "only one gene ENSMUSG00000022103.9" );

print "\$exp = " . root->print_perl_var_def( $value->{'data'} ) . ";\n";

$exp = [
	[ 'C_CCAATCCAGCTACCGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACCCACTGTTACCAGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGGCTGGCACCTCGGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGCCAAAGGGTTTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAACTTCAAATCCGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAAGTTGCAAGCCGCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGCAATTGTACCGCTG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GCATGTAGTGGTGTAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCGTCAGTGCTGTAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACGCCAGCACATGACT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCGTCAAGGGAGTAA', 'ENSMUSG00000034156.16', '6' ],
	[ 'C_CGCGGTACAGCCTTGG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_AGTGTCATCACCGGGT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TTGTAGGGTTTGCATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATTATCCAGCCCAACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GACAGAGGTACGCTGC', 'ENSMUSG00000034156.16', '4' ],
	[ 'C_CACTCCAGTTGGTTTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAGACCTGTGCACCAC', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_GCAGTTAAGACGACGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGACCAAGTCCTCCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AACTGGTTCCACTGGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGAATAATCACGGTTA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TTTGGTTCACACGCTG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_ATGGGAGGTCTAGTGT', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_TTCGAAGAGTTGTCGT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_ACGGCCAGTTCCTCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCTACCAGTGTCCAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CATCCACGTAAGTGGC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_AGGTCCGGTTCACCTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCAGGTATCAGCACAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CGAACATCATCCTAGA', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_AAAGTAGGTACCAGTT', 'ENSMUSG00000034156.16', '7' ],
	[ 'C_TCACGAATCACGCATA', 'ENSMUSG00000034156.16', '4' ],
	[ 'C_AAGGTTCTCCTCAATT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCCTAGTCTACGAGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACACCGGGTTGTTTGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTCCTAGTCCGTGAC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CTTGGCTGTTTCCACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGCATAAGTTTCCTT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATCGTACATCGATTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACATGGTAGATCTGCT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CATCGAACATGCTGGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGGCTGTTTGGCGCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TACCTTATCCCATTAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CCAGCGAGTAGCCTCG', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_CAGCGACGTTCACCTC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CAACTAGAGAGGTTGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTCACGGAGATCCGAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAAGCCATAATCCAAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGTGGGACAAACTGTC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CTCGGGATCTTGTATC', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_CGTCTACTCACCGTAA', 'ENSMUSG00000034156.16', '5' ],
	[ 'C_CTCTGGTCAGCTCGAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGCTAGTCGGACAAG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CCTACACAGCGTGAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGAGCCATCTCGCATC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACTTTCATCAATAAGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTAGGCAGTAGGGTAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AACTGGTTCATCGATG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CCGGTAGTCAATCTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACGAGGAGTGCCTGGT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GCAATCAGTAAGTGGC', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_TCAATCTTCTGATACG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_AGGCCGTCAGATCCAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TCCCGATTCGTCTGAA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TACAGTGGTACGCACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTAACTGCAGTATCTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTGCAGGTCCATCCT', 'ENSMUSG00000034156.16', '4' ],
	[ 'C_CTCACACGTACTTAGC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CGATGTACACACAGAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTGCTGTAGAGTAAGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGATGTTGTAGCGTGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCAATCACAAATTGCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGAGTCGTTCGGCAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATCACGAAGCCACTAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGTCCTAGACCTAGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTTACTGGTTGACGTT', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_CCTACCAAGTCCTCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGCCCATGTCAGAAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CATCGAAAGTGTCCAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CTCGTACCAGTTCATG', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_GTCACGGTCGAATGCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTCACAACACGTGAGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCACGAAGTTCCACGG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_ACTTACTAGTGTCCCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACCAGGCAGCGTAAG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GACCTGGTCACCATAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTATGCTGTTAGATGA', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_TGCGCAGTCGTTGCCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCAATCCCATCCTAGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCCCATGTCAGAAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACCAGGGTACTCGCG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GACTACAGTCTCACCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGTCAGGGTGCCTGTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TACTCGCAGTGAATTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CATGACAGTCATGCAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGGTGCGTGGGTATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGGGAAGTCACCCGAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCGTTCATCTCCAGGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGGGAAGCAGCCTGTG', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_CAAGAAAAGGCCATAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTGGGTCATATACGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGTGTTTTCAGTCAGT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TTGTAGGGTGCGCTTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGACCATCATAGCAC', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_CAGCGACGTATGAAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCTACCGTCTTGATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCCCATGTCATAAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAGGTTCGTCGAACAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GAATAAGTCTTCCTTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAAGATCTCAGCATGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACATAGAGCTAGCCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACTTGTTTCAACGCTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACCCACTTCTCTGAGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGTGGTATCCCTAATT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCAATCAGGGTTCGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGACGTCAGTATAAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCTATCTCTTGAGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGACCTTTCCGCGGTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCCCGATCAGTGAGTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTACTCCTCTGGTATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATCATCTCATGGTCAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_ACACTGAGTTGAACTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TAAGCGTGTTCGCGAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGACTGGTGCCTGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATCACGAGTTGGGACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATTACTCGTATCAGTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGACTAGTCAACGGCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TAAGAGAAGTTAGCGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CATGGCGTCACGGTTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCATTTGGTGTGCCTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCTGAGATCGCCATAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GACGCGTGTCCAACTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGCGATTCTTTAGGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGGAGATGTCAAACTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGGTCACATTAACCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACCACTAGTTATCGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTCTCCTAGTGAACAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CCAGCGAGTAAGAGGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TACTCATAGCAACGGT', 'ENSMUSG00000034156.16', '3' ],
	[ 'C_GAATGAAAGCGATTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTGCAGCAGCGAGAAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACATTTTCCGCATAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAACTTTCACATAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGATGGCAGATACACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCTCATAAGACAGACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGAAAGCCACTACAGT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_AACCGCGTCAACACCA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GGAATAAAGGAATCGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATAAAAAGCTGTTCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTTGGCTAGAAACCTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGTTCTGGTGACCAAG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CGTCAGGAGGGCACTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTGTAGGAGGTGCACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCTACGGTCCGTGAC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CACAGTATCGGTGTCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTCTTCGCAATGACCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACCACTGTAGCCTCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGGACACCACATGTGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCCAATCCATAGAAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACGATACAGTACGCCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGATGTACAATCAGAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAATGCCGTATTCTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTAACTGTCACCGGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCGTTTCAACTGGCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCTTCGACATAAGACA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TATGCCCAGGCTAGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCTACCCATGGATGG', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GAGTCCGTCCCTCAGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCCCGATAGCACGCCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGCTGGTGTCGAGATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAACCTGAGAAACCGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACATTTAGCCACGCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TAGTTGGAGAAGGTGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGTGTCTTCGTGGACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGGCCACGTGCGAAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGACATTAGACATAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGAGTGGGTCGAGATG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGTATTGGTCTAGCGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TAAGTGCCATAGACTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCATGTAGTAGCCTCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GACTAACTCGCACTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCTGCTAGCTATGCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGGTCTGCACACGCTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CATTCGCCATTCTCAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAGAGTCAAGTTAAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACGAGCCAGATAGTCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAAGATGCACCACGTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GAGCAGAGTACCGGCT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_TAGTTGGCAATGCCAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAAGAAAGTATTAGCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCTATCAGTGGTAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTCTTAGGTCTCCCTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACACAAGTCTAGCCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCGGGATGTCCAGTGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGATTGATCTGTTGAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CATATTCGTTCGAATC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCATGTCAGTACGTAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTCGGTCTCTGAGGGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GACAGAGGTGCACGAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AACCATGTCCAAGTAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCGAAAGTAGCTTGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAAGACTCTACTCAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TATTACCTCATGTGGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGCCGAGTTACCAGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTCTTAGAGGACCACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCTGGAAGGATCGCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCGTGGAGTACATGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TACGGTACATCTATGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACACTGAAGCGATTCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGTAGTCCACATGACT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTGGGTCGTGAGCGAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGAGAGAGTAGGCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGGAGATTCCTTTCGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGTGAGGTCTACTTAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGAGAAGTAGGAGTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTGCTTCTCTGTCTCG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCCCATAGCGATCCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCAAACTGTCTCTTTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCTATCAGAAACGCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTCCTAGTGATGATA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGAGCTTGTGCTCTTC', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_AAGGTTCGTACTTAGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACGGGTCCATGGGAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GACTACAAGGGAACGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAGTGAAGCCGGTAA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_ATATACCGTACAGTGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTAACTGTCAGTCCCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGAGGGATCTCAAGTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCTCTAATCTGAGGGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGCGTGTTCTAAGCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATGAAAGTACCCAAT', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_GCATACAGTGCGAAAC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AATCCAGCACACATGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGGTTCCCAGACAAAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTTGAAGTTTCCACC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCGTGGGTTTGTGTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGATTGACAGGGCATA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATCAGTTCCGTTGTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGCGGTATCCAGTAGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CCGGTAGCATTAGCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGACGTTTCCTAGGGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CGATCGGAGCACGCCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGATTACAGTGTGAAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACCGTAATCTCCAGGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTCTGGTGTGACGGTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGTCTTTCATGTCCTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCTGGGTAGCAATCTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATCCACCTCGCGCCAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAGAGTTTCTTTGCT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGACTAGTCTGTTTGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATGCTATCTGAGGGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TCACAAGGTAGCACGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AACTGGTAGGATCGCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTAACTGGTAGGCTGA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGTCCGGTTCACCTCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACATGGTAGACGACGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCACTCTCATGGGACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GATCGATAGATAGTCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TACCTATAGCGTCTAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTGAAGTGTATGCTTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GTCACGGGTACTCTCC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CTAAGACAGACACTAA', 'ENSMUSG00000034156.16', '2' ],
	[ 'C_CTCATTATCTTGTCAT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACAGCCGCATCCAACA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACCTTTACATAGACTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AGCATACTCCACTGGG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGCGGGTTCCACTCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GCGCCAATCTGTTGAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGGAATGAGTGTTGAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGTATTGGTAGATTAG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CAGCATAAGCACCGTC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTCTCCTTCACGGTTA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_GGGAATGAGAGGGATA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ATGTGTGAGGAGCGTT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACTGAGTCATTGCGGC', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGAGCCGGTATAAACG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TGGGAAGCATCGATTG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAAGATGGTTCCTCCA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_TTTGCGCCATGCATGT', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_CACAAACTCGGCTACG', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_ACTGAACTCACCGTAA', 'ENSMUSG00000034156.16', '1' ],
	[ 'C_AAGACCTGTGCACCAC', '1',                     '1' ],
	[ 'C_CGTCTACTCACCGTAA', '1',                     '1' ],
	[ 'C_CCGTTCATCTCCAGGG', '1',                     '1' ],
	[ 'C_GCTGCTTGTATCACCA', '1',                     '1' ],
	[ 'C_TAAGCGTGTTCGCGAC', '1',                     '1' ],
	[ 'C_CGTCAGGAGGGCACTA', '1',                     '1' ],
	[ 'C_GCTGGGTAGCAATCTC', '1',                     '1' ],
	[ 'C_CTGAAGTAGCCTATGT', '1',                     '1' ],
	[ 'C_CAACTAGCACCAACCG', '1',                     '1' ],
	[ 'C_GCGCGATGTTAAGATG', '1',                     '1' ],
	[ 'C_GTACTTTGTCTCCACT', '1',                     '1' ],
	[ 'C_GTACTCCGTCTTGCGG', '1',                     '1' ],
	[ 'C_AGCAGCCTCGCCAAAT', '1',                     '1' ],
	[ 'C_AGTGTCAAGTACGTTC', '1',                     '1' ],
	[ 'C_GTAGTCACAGCTTAAC', '1',                     '1' ],
	[ 'C_TACGGATAGGACATTA', '1',                     '1' ],
	[ 'C_ATCGAGTGTATAGGTA', '1',                     '1' ],
	[ 'C_TCAGATGGTTATCACG', '1',                     '1' ],
	[ 'C_CCGGGATCACACCGAC', '1',                     '1' ],
	[ 'C_CTCACACCAAACAACA', '1',                     '1' ],
	[ 'C_GACCATTAGCTGCTTG', '1',                     '1' ],
	[ 'C_ACCAGTAAGCCCAGCT', '1',                     '1' ],
	[ 'C_AGAGTGGGTCCGTGAC', '1',                     '1' ],
	[ 'C_ACAGCCGGTAACGTTC', '1',                     '1' ],
	[ 'C_CCCAATCGTGACTCAT', '1',                     '1' ],
	[ 'C_GACCTGGCACCAACCG', '1',                     '1' ],
	[ 'C_GATCGTACAGTCCTTC', '1',                     '1' ],
	[ 'C_TTAACTCGTTCCCATG', '1',                     '1' ],
	[ 'C_GCGGGCTTCACCAGGC', '1',                     '1' ],
	[ 'C_AGTGGTATCAACGCAG', '1',                     '1' ],
	[ 'C_GCTTGAAGTTCGGGCT', '1',                     '1' ],
	[ 'C_TCCCGATGTAGTACCT', '1',                     '1' ],
	[ 'C_GTGTTAGCATACAGCT', '1',                     '1' ],
	[ 'C_CTGATCCGTACATCCA', '1',                     '1' ],
	[ 'C_TGAGCCGGCAAAAAAG', '1',                     '1' ],
	[ 'C_ACGAGCCGTGGGTATG', '1',                     '1' ],
	[ 'C_GAACATCAGGTGATAT', '1',                     '1' ],
	[ 'C_ATAAGAGTCATACGGT', '1',                     '1' ],
	[ 'C_GCATACAGTGGTGTAG', '1',                     '1' ],
	[ 'C_TTCTACAGTTCCTCCA', '1',                     '1' ],
	[ 'C_CGTCTACTGAGTCGTT', '1',                     '1' ],
	[ 'C_ATGAGGGAGCCTATGT', '1',                     '1' ],
	[ 'C_GCTGGGTAGGACTGGT', '1',                     '1' ],
	[ 'C_GGGACCTCACCAGGCT', '1',                     '1' ],
	[ 'C_CTCGTCAGTGCTGTAT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GGAATAATCACGGTTA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CAGCGACGTTCACCTC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CTCGGGATCTTGTATC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CGTCTACTCACCGTAA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_AGAGCTTGTGCTCTTC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CCTATTAGGCTCTGTC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GTCACAAGCTGCTTGG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TTGTAGGCTCTGTCCA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GTGCAGCTCTGTCCAC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GACGCTCTCTTCTGGA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TCACAAGTTCAAATCC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GACTGCGCAAGCCATT', 'ENSMUSG00000009350.13', '3' ],
	[ 'C_TTGCCGTGTACTTAGC', 'ENSMUSG00000009350.13', '2' ],
	[ 'C_CCTATTACATTCCTCG', 'ENSMUSG00000009350.13', '2' ],
	[ 'C_CTTTGCGAGGCCCTCA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CCGTACTTCACAACGT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TTATGCTGTGGTCTCG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CTGGTCTAGGCCATAG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_AGCGGTCTCAGTGCAT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GGGAGATCCTTTCGGC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CACAAACAGCACCGCT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_ATGCGATAGCGAGAAA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CAGCAGCGTGGTACAG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_ATTGGTGTCTGGTATG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CTCTACGTCTGGTATG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TTGGAACGTGACTCAT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CGAGCACAGAGGTTGC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TACCTATAGTCAAGCG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_AAGCAGTGGTATCAAC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TTGACTTTCCGAATGT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GAGCAGGGTAGAGGAA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CATCAGAGTTGGAGGT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CCTGTTTTACTTCAAG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GTAGGCCTCTTCGAGA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_AGCAGTGGTATCAACG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_AGATTGCAGGCATGTG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CAAGTTGTCCACGTGG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_ATCACGAGTGTGCCTG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CGAATGTGTAGAAAGG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GGTTACGAATGGTGAT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GGATGTTGTTGGGACA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CCATGTCTCTGTCCGT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CCTACAAGGAGCGGAG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GGGTTGCGAATGGTGA', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_TAGCCGGCAGACGCTC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_ACCTTTACAAACGTGG', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_ATGTGTGTCCACGAAT', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_GCAATCACATAGACTC', 'ENSMUSG00000009350.13', '1' ],
	[ 'C_CGGCTAGTCGGACAAG', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_ATCACGAGTGTGCCTG', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_TTGACTTCATCACAAC', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_TTCTCCTGTCGACTAT', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_TAAGAGAAGCTCTCGG', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_TAAGCGTAGGGATCTG', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_CACACTCAGTAGCGGT', 'ENSMUSG00000009356.12', '1' ],
	[ 'C_ACTGAGTCATTGCGGC', 'ENSMUSG00000034121.12', '1' ],
	[ 'C_ACGTCAATCGGTGTTA', 'ENSMUSG00000034121.12', '1' ],
	[ 'C_ACTGCTCAGAGCTGGT', 'ENSMUSG00000034121.12', '1' ],
	[ 'C_CTAGAGTGTCCAAGTT', 'ENSMUSG00000034121.12', '1' ]
];

is_deeply( $value->{'data'}, $exp, "all data OK" );

#print "\$exp = ".root->print_perl_var_def($value ).";\n";
